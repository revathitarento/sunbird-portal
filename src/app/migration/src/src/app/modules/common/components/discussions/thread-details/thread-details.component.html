<div class="ui padded grid">
    <div class="row">
        <div class="twelve wide column">
            <div class="ui grid">
                <div class="one wide column"></div>
                <div class="eight wide column">
                    <div class="ui segment">
                        <div [ngClass]="loading? 'ui active inverted dimmer' : ''">
                            <div class="ui text loader">Loading</div>
                        </div>
                        <div class="ui top padded grid">
                            <div class="text-align-left">
                                <a class="cursor-pointer go-back-arrow" [routerLink]="['/migration/thread-list', id]">
                                    <i class="large arrow left icon"></i>
                                </a>
                            </div>
                            <div class="cardsHeading">
                                {{threadDetails.thread.title}}
                            </div>
                            <br/>
                            <div class="content description">{{threadDetails.thread.body}}</div>
                            <div class="ui comments">
                                <div class="comment">
                                    <div class="content">
                                        <div class="metadata">
                                            <span class="author">{{threadDetails.thread.author.userName}}</span>
                                            <span> | </span>
                                            <span>{{replies.length}} replies</span>
                                            <span *ngIf="threadDetails.thread.actions.vote != undefined && threadDetails.thread.actions.vote >= 0" title="like" class="cursor-pointer" (click)="upVoteAction(threadDetails.thread.descId,threadDetails.thread.actions.vote === 1)">
                                                <i class="custom-vote-icon thumbs up icon" [ngClass]="threadDetails.thread.actions.vote == 1?'blue':''"></i>{{message.like_count}}
                                            </span>
                                            <!-- <span title="like" class="cursor-pointer" (click)="undoActions(threadDetails.thread.id)">
                                                <i class="custom-vote-icon thumbs up blue icon"></i>{{message.like_count}}
                                            </span> -->
                                            <span *ngIf="threadDetails.thread.actions.downVote != undefined && threadDetails.thread.actions.downVote >= 0" title="dislike" class="cursor-pointer" (click)="downVoteAction(threadDetails.thread.descId,threadDetails.thread.actions.downVote === 1)">
                                                <i class="custom-vote-icon thumbs down icon" [ngClass]="threadDetails.thread.actions.downVote == 1?'blue':''"></i>0
                                            </span>
                                            <span title="share a link to this thread" class="cursor-pointer" [cbContent]="href" ngxClipboard (cbOnSuccess)="linkShare()">
                                                <i class="linkify icon"></i>
                                            </span>
                                            <span title="delete this thread" class="cursor-pointer">
                                                <i class="trash outline icon"></i>
                                            </span>
                                            <span *ngIf="lockedId !== threadDetails.thread.id || lockedState == false" title="lock this post" class="cursor-pointer"
                                                (click)="onLock(threadDetails.thread.id,false)">
                                                <i class="lock icon"></i>
                                            </span>
                                            <span *ngIf="lockedId == threadDetails.thread.id && lockedState == true" title="unlock this post" class="cursor-pointer"
                                                (click)="onLock(threadDetails.thread.id,true)">
                                                <i class="unlock alternate icon ui red"></i>
                                            </span>
                                            <span *ngIf="archivedId !== threadDetails.thread.id || archivedState == false" title="archive this post" class="cursor-pointer"
                                                (click)="onArchive(threadDetails.thread.id,false)">
                                                <i class="archive icon"></i>
                                            </span>
                                            <span *ngIf="archivedId == threadDetails.thread.id && archivedState == true" title="unarchive this post" class="cursor-pointer"
                                                (click)="onArchive(threadDetails.thread.id,true)">
                                                <i class="archive icon ui brown"></i>
                                            </span>
                                            <span class="date">{{threadDetails.thread.createdDate | date : longdate}}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="ui divider"></div>
                        <div title="sort" class="ui dropdown" suiDropdown>
                            <small class="text">Sort by</small>
                            <i class="dropdown icon"></i>
                            <div class="menu" suiDropdownMenu>
                                <div class="item" (click)="ascSortClick()">
                                    Older
                                </div>
                                <div class="item" (click)="descSortClick()">
                                    Newer
                                </div>
                            </div>
                        </div>
                        <div class="ui comments margin-top-10">
                            <div class="comment" *ngFor="let reply of threadDetails.thread.replies | sortByDate:param">
                                <div class="content padding-top-20">
                                    <div class="metadata">
                                        <i class="user circle outline black large icon"></i>
                                        <span class="author">{{reply.author.userName}}</span>
                                        <span> | </span>
                                        <div class="date">{{reply.createdDate | date : longDate}}</div>
                                    </div>
                                    <div class="text margin-left-10">{{reply.body}}</div>
                                    <div class="actions metadata">
                                        <span *ngIf="reply.actions.vote != undefined && reply.actions.vote >= 0" title="{{vote}}" class="cursor-pointer" (click)="actions(reply.id,2)">
                                            <i class="custom-vote-icon thumbs up icon" [ngClass]="reply.actions.like ==1 ?'blue':''"></i>
                                        </span>
                                        <!-- <span *ngIf="showAction(reply.id,2) == 'acted'" title="undo like" class="cursor-pointer" (click)="undoActions(reply.id,2)">
                                            <i class="custom-vote-icon thumbs up blue icon"></i>
                                        </span> -->
                                        <span *ngIf="reply.actions.downVote != undefined && reply.actions.downVote >= 0" title="dislike" class="cursor-pointer" (click)="voteAction(reply.id)">
                                            <i class="custom-vote-icon thumbs down icon"></i>
                                        </span>
                                        <span *ngIf="showAction(reply.id,5) == 'acted'" title="undo dislike" class="cursor-pointer" (click)="undoActions(reply.id,5)">
                                            <i class="custom-vote-icon thumbs down blue icon"></i>
                                        </span>
                                        <span>
                                            <span *ngIf="reply.actions.flag != undefined && reply.actions.flag >= 0" title="flag as spam" class="cursor-pointer" (click)="actions(reply.id,8)">
                                                <i class="custom-vote-icon flag icon"></i>
                                            </span>
                                            <span *ngIf="showAction(reply.id,8) == 'acted'" title="undo spam" class="cursor-pointer" (click)="undoActions(reply.id,8)">
                                                <i class="custom-vote-icon flag blue icon"></i>
                                            </span>
                                        </span>
                                        <div *ngIf="markRepId !== reply.id || markResValue == false">
                                            <span title="Mark as Right Answer" class="cursor-pointer" (click)="markAsCorrect(reply.id,false)">
                                                <i class="custom-vote-icon checkmark icon"></i>
                                            </span>
                                        </div>
                                        <div *ngIf="markRepId == reply.id &&  markResValue == true">
                                            <span title="Undo Marked" class="cursor-pointer" (click)="markAsCorrect(reply.id,true)">
                                                <i class="custom-vote-icon checkmark icon ui green"></i>
                                            </span>
                                        </div>
                                        <span>{{reply.reads}} views</span>
                                        <span title="share a link to this post" class="cursor-pointer" [cbContent]="href + '#' + reply.id" ngxClipboard (cbOnSuccess)="linkShare()">
                                            <i class="linkify icon"></i>
                                        </span>
                                        <span *ngIf="deletedId !== reply.id || deletedState == false" title="delete this post" class="cursor-pointer" (click)="onDelete(reply.id,false)">
                                            <i class="trash outline icon"></i>
                                        </span>
                                        <span *ngIf="deletedId == reply.id && deletedState == true" title="undelete this post" class="cursor-pointer" (click)="onDelete(reply.id,true)">
                                            <i class="trash outline icon ui red"></i>
                                        </span>
                                        <!-- <span *ngIf="lockedId !== reply.id || lockedState == false" title="lock this post" class="cursor-pointer" (click)="onLock(reply.id,false)">
                                            <i class="lock icon"></i>
                                        </span>
                                        <span *ngIf="lockedId == reply.id && lockedState == true" title="unlock this post" class="cursor-pointer" (click)="onLock(reply.id,true)">
                                            <i class="unlock alternate icon ui red"></i>
                                        </span> -->
                                        <span title="edit this post" class="cursor-pointer" (click)="onEditReply(reply.id)">
                                            <i class="write icon"></i>
                                        </span>
                                        <!-- <span *ngIf="archivedId !== reply.id || archivedState == false" title="archive this post" class="cursor-pointer" (click)="onArchive(reply.id,false)">
                                            <i class="archive icon"></i>
                                        </span>
                                        <span *ngIf="archivedId == reply.id && archivedState == true" title="unarchive this post" class="cursor-pointer" (click)="onArchive(reply.id,true)">
                                            <i class="archive icon ui brown"></i>
                                        </span> -->
                                    </div>
                                    <!--Notification-->
                                    <div class="error_notify margin-top-15">
                                        <div class="ui tiny green message" *ngIf="actId == 2 && repId == reply.id && notifyActions == true && actionType == 'can_act'">Like removed</div>
                                        <div class="ui tiny green message" *ngIf="actId == 2 && repId == reply.id && notifyActions == true && actionType == 'acted'">Liked the post </div>

                                        <div class="ui tiny orange message" *ngIf="actId == 5 && repId == reply.id && notifyActions == true && actionType == 'can_act'">Dislike removed</div>
                                        <div class="ui tiny orange message" *ngIf="actId == 5 && repId == reply.id && notifyActions == true && actionType == 'acted'">Post is disliked</div>

                                        <div class="ui tiny red message" *ngIf="actId == 8 && repId == reply.id && notifyActions == true  && actionType == 'can_act'">Spam removed</div>
                                        <div class="ui tiny red message" *ngIf="actId == 8 && repId == reply.id && notifyActions == true  && actionType == 'acted'">Post is spammed</div>
                                    </div>
                                    <!--Notification ends-->
                                </div>
                            </div>
                        </div>
                        <form class="ui reply form" name="answerForm" (ngSubmit)="submitReply()" novalidate="">
                            <div *ngIf="successMessage" class="field">
                                <div class="ui positive message">
                                    <div class="header">
                                        Your answer has been added successfully.
                                    </div>
                                </div>
                            </div>
                            <div class="field">
                                <div id="custom-toolbar" [froalaEditor] name="replyAnswer" minlength="20" [(ngModel)]="discussionsModel.replyAnswer" #replyAnswer="ngModel"></div>
                                <!-- <textarea type="text" name="replyAnswer" [(ngModel)]="discussionsModel.replyAnswer" minlength="20" required #replyAnswer="ngModel"></textarea> {{replyAnswer.className}} -->
                                <div class="ui negative message" [hidden]="replyAnswer.valid || replyAnswer.pristine">
                                    This is a required field.
                                </div>
                                <div class="ui negative message" *ngIf="replyAnswer.errors?.minlength">
                                    Your reply must be at least 20 characters long.
                                </div>
                            </div>
                            <div class="text-align-right">
                                <button class="ui primary submit icon button" [ladda]="isLoading" data-style="slide-right" data-spinner-color="white" [disabled]="discussionsModel.replyAnswer == ''"
                                    type="submit">
                                    <span class="ladda-label">Add your reply</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="three wide column"></div>
            </div>
        </div>
    </div>
</div>